(x - mean(x))/sd(x)
x <- c(0.8, 0.47, 0.51, 0.73, 0.36, 0.58, 0.57, 0.85, 0.44, 0.42)
y <- c(1.39, 0.72, 1.55, 0.48, 1.19, -1.59, 1.23, -0.65, 1.49, 0.05)
lm(y~x)
lm(scale(y)~scale(x))
x <- c(0.8, 0.47, 0.51, 0.73, 0.36, 0.58, 0.57, 0.85, 0.44, 0.42)
mean(x)
x <- c(0.18, -1.54, 0.42, 0.95)
x)
x <- c(0.18, -1.54, 0.42, 0.95)
sum(w*x)/w
sum(w*x)/sum(w)
x <- c(0.8, 0.47, 0.51, 0.73, 0.36, 0.58, 0.57, 0.85, 0.44, 0.42)
y <- c(1.39, 0.72, 1.55, 0.48, 1.19, -1.59, 1.23, -0.65, 1.49, 0.05)
lm(y~x-1)
1.5*.6
1.5*.4
x <- c(8.58, 10.46, 9.01, 9.64, 8.86)
mean(x)
x-mean(x)
scale(x)
(x-mean(x))/sd(x)
x <- c(0.8, 0.47, 0.51, 0.73, 0.36, 0.58, 0.57, 0.85, 0.44, 0.42)
y <- c(1.39, 0.72, 1.55, 0.48, 1.19, -1.59, 1.23, -0.65, 1.49, 0.05)
lm(y~x)
x <- c(0.8, 0.47, 0.51, 0.73, 0.36, 0.58, 0.57, 0.85, 0.44, 0.42)
mean(x)
?scale_size
?scale_size
swirl()
fit0 <- lm(mpg~1,mtcars)
fit0
fit1 <- lm(mpg~factor(am), mtcars)
fit1
factor
geom_point() +
facet_wrap(wt)
g
g <- ggplot(mtcars, aes(x=factor(am), y=mpg,colour=factor(am))) +
geom_point() +
facet_wrap(wt)
g
ggplot(mtcars, aes(x=factor(am), y=mpg,colour=factor(am))) +
geom_point() +
facet_wrap(wt)
library('ggplot2')
ggplot(mtcars, aes(x=factor(am), y=mpg,colour=factor(am))) +
geom_point() +
facet_wrap(wt)
g <- ggplot(mtcars, aes(x=factor(am), y=mpg,colour=factor(am))) +
geom_point() +
facet_grid(wt)
g
ggplot(mtcars, aes(x=factor(am), y=mpg,colour=factor(am))) +
geom_point() +
facet_grid(wt)
g <- ggplot(mtcars, aes(x=factor(am), y=mpg,colour=factor(am))) +
geom_point() +
facet_grid(. ~ wt)
g
g <- ggplot(mtcars, aes(x=wt, y=mpg,colour=factor(am))) +
geom_point() +
facet_grid(. ~ am)
g
g <- ggplot(mtcars, aes(x=wt, y=mpg,colour=factor(am))) +
geom_point() +
geom_smooth(method='lm')
facet_grid(. ~ am)
g
g <- ggplot(mtcars, aes(x=hp, y=mpg,colour=factor(am))) +
geom_point() +
geom_smooth(method='lm')
facet_grid(. ~ am)
g
g <- ggplot(mtcars, aes(x=factor(am), y=mpg,colour=factor(am))) +
geom_point() +
facet_grid(. ~ factor(cyl))
g
g <- ggplot(mtcars, aes(x=factor(am), y=mpg,colour=factor(am))) +
geom_point() +
facet_grid(. ~ wt)
g
g <- ggplot(mtcars, aes(x=factor(am), y=mpg,colour=factor(am))) +
geom_point() +
facet_grid(. ~ cyl)
g
g <- ggplot(mtcars, aes(x=factor(am), y=mpg,colour=factor(am))) +
geom_point() +
geom+smooth(method='lm')
facet_grid(. ~ cyl)
g
g <- ggplot(mtcars, aes(x=factor(am), y=mpg,colour=factor(am))) +
geom_point() +
geom_smooth(method='lm')
facet_grid(. ~ cyl)
g
g <- ggplot(mtcars, aes(x=factor(am), y=mpg,colour=factor(am))) +
geom_point() +
geom_smooth(method='lm')
facet_grid(. ~ factor(cyl))
g
g <- ggplot(mtcars, aes(x=factor(am), y=mpg,colour=factor(am))) +
geom_point() +
geom_smooth(method='lm',aes(group=1))
facet_grid(. ~ factor(cyl))
g
g <- ggplot(mtcars, aes(x=factor(am), y=mpg,colour=factor(am))) +
geom_point() +
facet_grid(. ~ factor(cyl)) +
geom_smooth(method='lm')
g
g <- ggplot(mtcars, aes(x=factor(am), y=mpg,colour=factor(am))) +
geom_point() +
facet_grid(. ~ cyl) +
geom_smooth(method='lm')
g
g <- ggplot(mtcars, aes(x=factor(am), y=mpg,colour=factor(am))) +
geom_point() +
facet_grid(. ~ cyl) +
geom_smooth(method='lm', aes(group=1))
g
summary(lm(mpg~factor(am)+cyl))
summary(lm(mpg~factor(am)+cyl),mtcars)
lm(mpg~factor(am)+cyl)
lm(mpg~factor(am),mtcars)
lm(mpg~factor(am)+factor(cyl),mtcars)
lm(mpg~factor(am)+factor(cyl),mtcars)
summary(lm(mpg~factor(am)+factor(cyl),mtcars))
fit4 <- lm(mpg~am+wt+hp+vs)
fit4 <- lm(mpg~am+wt+hp+vs,mtcars)
anova(fit3,fit4)
fit0 <- lm(mpg~1,mtcars)
fit1 <- lm(mpg~am, mtcars)
fit2 <- update(fit, mpg~am+wt)
fit3 <- update(fit, mpg~am+wt+hp)
fit0 <- lm(mpg~1,mtcars)
fit1 <- lm(mpg~am, mtcars)
fit2 <- update(fit1, mpg~am+wt)
fit3 <- update(fit1, mpg~am+wt+hp)
anova(fit3,fit4)
summary(mpg~am+vs)
summary(lm(mpg~am+vs))
summary(lm(mpg~am+vs,mtcars))
summary(lm(mpg~am+vs+wt,mtcars))
swirl()
library('swirl')
swirl()
x1c<-simbias()
View(x1c)
apply(x1c,1,mean)
fit1 <- lm(Fertility~Agriculture,swiss)
fit3<- lm(Fertility~Agriculture+Examination+Education)
fit3<- lm(Fertility~Agriculture+Examination+Education,swiss)
anove(fit1,fit3)
anova(fit1,fit3)
deviance(fit3)
d <- deviance(fit3)/43
n <- (deviance(fit1)-deviance(fit3))/2
n/d
pf(n/d,2,43,lower.tail=FALSE)
shapiro.test(fit3$residuals)
anova(fit1,fit3,fit5,fit6)
ravenData
glm(ravenWinNum~ravenScore,binomial,ravenData)
mdl<-glm(ravenWinNum~ravenScore,binomial,ravenData)
lodds <- predict(mdl,data.frame(ravenScore(c(0,3,6))))
lodds <- predict(mdl,data.frame(ravenScore=(c(0,3,6))))
lodds <- predict(mdl,data.frame(ravenScore=c(0,3,6)))
exp(lodds)/(1+exp(lodds))
summary(mdl)
exp(confint(mdl))
anova(mdl)
qchisq(0.95,1)
var(rpois(1000,50))
nxt()
tail(hits)
class(hits[,'date'])
as.integer(head(hits[,'date']))
mdl <- glm(visits~date,poisson,hits)
summary(mdl)
confint(mdl,'date')
exp(confint(mdl,'date'))
which.max(hits[,'visits'])
hits[704,]
lambda<-mdl$fitted.values[704]
qpois(.95,lambda)
mdl2 <- glm(simplyStats~date,data=hits,family=poisson,offset=log(visits+1))
mdl2 <- glm(visits~date,data=hits,family=poisson,offset=log(visits+1))
mdl2 <- glm(simplystats~date,data=hits,family=poisson,offset=log(visits+1))
qpois(.95,mdl2$fitted.value[704])
qpois(.95, mdl2$fitted.values[704])
?shuttle
names(shuttle)
shuttle
library('MASS')
shuttle
names(shuttle)
?glm
library('dplyr')
shuttle1 <- tbl_df(shuttle)
shuttle1 <- shuttle1 %>% mutate(auto = ifelse(use=='auto',1,0))
shuttle1
glm(auto~wind,family='binomial',data='shuttle1')
glm(auto~factor(wind),family='binomial',data='shuttle1')
glm(auto~factor(wind),family=binomial,data='shuttle1')
tail(shuttle1)
shuttle1 <- shuttle1 %>% mutate(headwind = ifelse(wind=='head',1,0))
shuttle1
glm(auto~headwind,family='binomial',data=shuttle1)
fit1 <- glm(auto~headwind,family='binomial',data=shuttle1)
exp(confint(fit1))
fit1 <- glm(auto~wind,family='binomial',data=shuttle1)
exp(confint(fit1))
fit1
fit1 <- glm(auto~wind,family='binomial',data=shuttle1)
fit1
fit1$coef[2]
exp(fit1$coef[2])
exp(fit1$coef)
shuttle1$wind
shuttle1$wind <- factor(shuttle1$wind, levels=c('tail','head'))
shuttle1$wind
fit1 <- glm(auto~wind,family='binomial',data=shuttle1)
fit1
exp(fit1$coefficients)
exp(fit1$coef)
fit2 <- glm(auto~wind+magn,family='binomial',data=shuttle1)
exp(fit2$coefficients)
shuttle1
fit1
fit1$coefficients
shuttle1$wind <- factor(shuttle1$wind, levels=c('head','tail'))
fit0 <- glm(auto~wind,family='binomial',data=shuttle1)
fit0$coefficients
InsectSprays
sprayFit1<- glm(count~factor(spray),family='poisson',data=InsectSprays)
sprayFit1
exp(sprayFit1$coefficients)
InsectSprays$spray
InsectSprays$spray <- factor(InsectSprays$spray,levels=c('B','A','C','D','E','F'))
sprayFit1<- glm(count~factor(spray),family='poisson',data=InsectSprays)
exp(sprayFit1$coefficients)
mtcars
fit2
glm(formula = auto ~ wind + I(magn+log(10))), family = "binomial", data = shuttle1)
glm(formula = auto ~ wind + I(magn+log(10)), family = "binomial", data = shuttle1)
x <- -5:5
y <- c(5.12, 3.93, 2.67, 1.87, 0.52, 0.08, 0.93, 2.05, 2.54, 3.87, 4.97)
knots <- 0
splineTerms <- (x > knots) * (x - knots)
xMat <- cbind(1,x,splineTerms)
xMat
yhat <- predict(lm(y~xMat-1))
plot(x,y, frame=FALSE, pch=21,bg='lightblue', cex=2)
lines(x,yhat,col="red",lwd=2)
yhat
lm(y~xMat-1)
z <- c(0,5)
lm(y~z)
y
y[6:10]
y[6:11]
lm(y[6:11]~z)
z
z <- c(0,1,2,3,4,5)
lm(y[5:11]~z)
lm(y[6:11]~z)
z <- c(1,2,3,4,5)
lm(y[6:11]~z)
lm(y[5:11]~z)
lm(y[7:11]~z)
z <- c(,-1,0,1,2,3,4,5)
z <- c(-1,0,1,2,3,4,5)
lm(y[5:11]~z)
-1.0242+2.0372
swirl()
ravenData
mdl <- glm(ravenWin~ravenScore,family='binomial',data=ravenData)
lodds <- predict(mdl, data.frame(ravenScore=c(0, 3, 6)))
exp(lodds)/(1+exp(lodds))
summary(mdl)
confint(mdl)
exp(confint(mdl))
anova(mdl)
chisq(.95,1)
qchisq(.95,1)
var(rpois(1000, 50))
tail(hits)
class(hits[,'date'])
as.integer(head(hits[,'date']))
mdl <- glm(visits ~ date, poisson, hits)
summary(mdl)
exp(confint(mdl, 'date')
)
which.max(hits[,'visits'])
hits[704,]
mdl$fitted.values[704]
lambda <- mdl$fitted.values[704]
qpois(.95,lambda)
mdl2 <- glm(simplystats~date,poisson,hits,offset=log(visits+1))
summary(mdl2)
qpois(.95, mdl2$fitted.values[704])
shuttle1
shuttle1$wind
shuttle1$wind <- factor(shuttle1$wind,levels=c('tail','head'))
shut1fit <- glm(auto~wind,binomial,shuttle1)
exp(shut1fit$coefficients)
shut2fit <- glm(auto~wind+magn,binomial,shuttle1)
exp(shut2fit$coefficients)
sprayFit1
exp(sprayFit1$coefficients)
?cats
library(AppliedPredictiveModeling)
?cats
?lakers
head(lakers)
library('MASS')
library('lubridate')
?lakers
colnames(lakers)
head(lakers)
length(lakers)
rows(lakers)
size(lakers)
nrows(lakers)
n_rows(lakers)
?nrow
nrow(lakers)
library('UsingR')
?wellbeing
data("wellbeing")
View(wellbeing)
avg(wellbeing)
mean(wellbeing)
?sapply
sapply(mean,wellbeing)
wellbeing
sapply(mean,wellbeing)
?wellbeing
sapply(wellbeing,mean)
?wellbeing
avg(wellbeing.Equality)
avg(wellbeing$Equality)
mean(wellbeing$Equality)
typeof(wellbeing$Equality))
typeof(wellbeing$Equality)
wellbeing$Equality <- as.numeric(wellbeing$Equality)
mean(wellbeing$Equality)
?mean
mean(wellbeing$Equality, na.rm=TRUE)
summary(wellbeing$Equality)
?train
library(caret)
?train
library(manipulate)
myPlot <- function(s) {
plot(cars$dist - mean(cars$dist), cars$speed - mean(cars$speed))
abline(0, s)
}
manipulate(myPlot(s), s = slider(0, 2, step = 0.1))
library(rCharts)
dTable(airquality, sPaginationType = "full_numbers")
library(manipulate)
myPlot <- function(s) {
plot(cars$dist - mean(cars$dist), cars$speed - mean(cars$speed))
abline(0, s)
}
manipulate(myPlot(s), s = slider(0, 2, step = 0.1))
shiny::runApp('RProg/devdataprod-032')
mdat <- matrix(c(1,2,3, 11,12,13), nrow = 2, ncol = 3, byrow = TRUE,
dimnames = list(c("row1", "row2"),
c("C.1", "C.2", "C.3")))
mdat
typeof(mdat)
shiny::runApp('RProg/devdataprod-032')
shiny::runApp('RProg/devdataprod-032')
?as.data.frame
spa
spam
as.data.frame(spam[,1])
as.data.frame(spam[1,])
test <- as.data.frame(spam[1,])
?colnames
colnames(test) <- colnames(spam)
test
?list
list(spam[1,])
as.data.frame(list(c(1,2,3,4)))
shiny::runApp('RProg/devdataprod-032')
print(test)
colnames(test) <- colnames(spam)
shiny::runApp('RProg/devdataprod-032')
test2 <- '$$$$ bad shit is happening'
str_count(test2,'$')
str_count(test2,'\$')
str_count(test2,'/$')
test2 <- '$$$$ bad shit is happening shit shit shit'
str_count(test2,'shit')
str_count(test2,'\\$')
test2 <- '##$$!![();'
test2 <- '##$$!![[(();;'
str_count(test2,'\\$')
str_count(test2,'#')
str_count(test2,'!')
str_count(test2,'\\[')
str_count(test2,'\\(')
str_count(test2,'\\)')
str_count(test2,';')
shiny::runApp('RProg/devdataprod-032')
?rpart
library('rpart')
?rpart
library(rpart.plot)
?rpart.plot
?rpart
test <- test <- train(spam ~ ., method='rpart')
test <- test <- train(spam ~ ., method='rpart', data=spam)
test <- train(spam ~ ., method='rpart', data=spam)
test
rpart.plot(test)
?rpart.plot
test <- rpart(spam ~ ., method='rpart', data=spam)
test <- rpart(spam ~ ., data=spam)
test
rpart.chart(test)
rpart.plot(test)
test1 <- list()
test1$A.1 <- 'blah'
test1
colnames(test1) <- c('shit')
test1
colnames(spam2) <- c('make','address','all','3d','our','over','remove','internet','order','mail','receive','will','people','report','addresses','free','business','email','you','credit','your','font','000','money','hp','hpl','george','650','lab','labs','telnet','857','data','415','85','technology','1999','parts','pm','direct','cs','meeting','original','project','re','edu','table','conference',';','(','[','!','$','#','capital_average','capital_longest','capital_total', 'spam')
spam2 <- spam
colnames(spam2) <- c('make','address','all','3d','our','over','remove','internet','order','mail','receive','will','people','report','addresses','free','business','email','you','credit','your','font','000','money','hp','hpl','george','650','lab','labs','telnet','857','data','415','85','technology','1999','parts','pm','direct','cs','meeting','original','project','re','edu','table','conference',';','(','[','!','$','#','capital_average','capital_longest','capital_total', 'spam')
head(spma2)
head(spam2)
predict(test,newdata=spam[274,])
?rf
?randomForest
controls <- trainControl(method="cv", 5, allowParallel = TRUE)
model <- randomForest(spam ~ ., trcontrol=controls, data=spam, ntree=5)
model
controls <- trainControl(method="cv", 5, allowParallel = TRUE)
model <- randomForest(spam ~ ., trcontrol=controls, data=spam, ntree=25)
model
predict(model,newdata=spam[274,])
predict(model,newdata=spam[275,])
predict(model,newdata=spam[279,])
predict(model,newdata=spam[1,])
predict(model,newdata=spam[2,])
predict(model,newdata=spam[3,])
predict(model,newdata=spam[4,])
shiny::runApp('RProg/devdataprod-032')
spam[1:3]
shiny::runApp('RProg/devdataprod-032')
install.packages('shinyjs')
test7 <- 'spam'
test7 =='spam'
shiny::runApp('RProg/devdataprod-032')
shiny::runApp('RProg/devdataprod-032')
shiny::runApp('RProg/devdataprod-032')
shiny::runApp('RProg/devdataprod-032')
?randomForest
shiny::runApp('RProg/devdataprod-032')
controls <- trainControl(method="cv", 5, allowParallel = TRUE)
model <- randomForest(spam ~ ., trcontrol=controls, data=spam, ntree=500)
model
controls <- trainControl(method="cv", 5, allowParallel = TRUE)
model <- randomForest(spam ~ ., trcontrol=controls, data=spam, ntree=1000)
model
(treesize(randomForest(Species ~ ., data=iris, maxnodes=4, ntree=30)))
set.seed(101)
controls <- trainControl(method="cv", 5, allowParallel = TRUE)
model <- randomForest(spam ~ ., trcontrol=controls, data=spam, ntree=500)
model
shiny::runApp('RProg/devdataprod-032')
shiny::runApp('RProg/devdataprod-032')
shiny::runApp('RProg/devdataprod-032')
shiny::runApp('RProg/devdataprod-032')
shiny::runApp('RProg/devdataprod-032')
?spam
shiny::runApp('RProg/devdataprod-032')
controls <- trainControl(method="cv", 5, allowParallel = TRUE)
model <- randomForest(spam ~ ., trcontrol=controls, data=spam, ntree=2000)
model
?rpart
model2 <- rpart(spam ~ ., spam)
rpart.plot(model2)
library('rpart.plot')
rpart.plot(model2)
plot(model2)
model2
model2 <- rpart(spam ~ ., spam)
plot(model2)
setwd("~/RProg/devdataprod-032")
library('rpart')
library('rpart.plot')
library(ElemStatLearn)
model2 <- rpart(spam ~ .,spam)
rpart.plot(model2)
spam2 <- spam
colnames(spam2) <- c('make','address','all','3d','our','over','remove','internet','order','mail','receive','will','people','report','addresses','free','business','email','you','credit','your','font','000','money','hp','hpl','george','650','lab','labs','telnet','857','data','415','85','technology','1999','parts','pm','direct','cs','meeting','original','project','re','edu','table','conference',';','(','[','!','$','#','capital_average','capital_longest','capital_total', 'spam')
model2 <- rpart(spam ~ .,spam2)
rpart.plot(model2)
model2
colnames(spam2) <- c('make','address','all','3d','our','over','remove','internet','order','mail','receive','will','people','report','addresses','free','business','email','you','credit','your','font','000','money','hp','hpl','george','650','lab','labs','telnet','857','data','415','85','technology','1999','parts','pm','direct','cs','meeting','original','project','re','edu','table','conference',';','(','[','!','$','#','cap_average','cap_longest','cap_total', 'spam')
model2 <- rpart(spam ~ .,spam2)
rpart.plot(model2)
?rpart.plot
?rpart
rpart
model2
